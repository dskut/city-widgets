<!DOCTYPE html>
<html lang="ru">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <title>Data widjet</title>

<script src="http://api-maps.yandex.ru/2.0-stable/?load=package.standard&lang=ru-RU" type="text/javascript"></script>

  <script type="text/javascript" src="//www.google.com/jsapi"></script>
  <script type="text/javascript" src="/data/dtp.js"></script>
  <script type="text/javascript">
  </script>
  <script type="text/javascript">
    google.load('visualization', '1', {packages: ['motionchart']});

    var motionchart;

    function drawVisualization() {
      var data = new google.visualization.DataTable();
      console.log(data1);

      for (i = 0; i < data1.cols.length; ++i) {        
        data.addColumn(data1.cols[i][0],data1.cols[i][1]);        
      }    
      data.addRows(data1.rows);
    
      motionchart = new google.visualization.MotionChart(document.getElementById('visualization'));
      var options = {};
      options['state'] =
'{"xLambda":1,"yZoomedDataMin":0,"yLambda":1,"orderedByX":true,"dimensions":{"iconDimensions":["dim0"]},"time":"2008-07-16T14:59:25.440","uniColorForNonSelected":false,"duration":{"timeUnit":"D","multiplier":1},"xAxisOption":"2","playDuration":15000,"yAxisOption":"2","xZoomedDataMin":0,"colorOption":"_UNIQUE_COLOR","yZoomedIn":false,"iconKeySettings":[],"nonSelectedAlpha":0.4,"xZoomedIn":false,"showTrails":false,"iconType":"VBAR","xZoomedDataMax":3,"orderedByY":false,"yZoomedDataMax":23,"sizeOption":"_UNISIZE"}';
options['width']= 800;
options['height']= 280;

      motionchart.draw(data,options); 
    }
    
   google.setOnLoadCallback(drawVisualization);


   function debug1()
   {
     console.log('debug1');
     var state=motionchart.getState();
     console.log(state);
   }
  </script>

<script type="text/javascript">

ymaps.ready(init);

function init() {
      var last_t=0;

	var myMap = new ymaps.Map('map', {
            center: [55.734046, 37.588628],
            zoom: 3,
            behaviors: ['default', 'scrollZoom']
        });

      for (i = 0; i < data1.titles.length; ++i) {        

    ymaps.geocode(data1.titles[i], { results: 1 }).then(function (res) {
        var firstGeoObject = res.geoObjects.get(0);
        console.log(firstGeoObject.geometry.getCoordinates());
	myPlacemark1 = new ymaps.Placemark(firstGeoObject.geometry.getCoordinates(), {
            //iconContent: i,
            balloonContent: data1.titles[i]
            //hintContent: 'hint'
        }, {
            preset: 'twirl#violetIcon'
        }),
         myMap.geoObjects.add(myPlacemark1);
       }, function (err) {
        console.log(err.message);
    });
   }
/*
    function attachReverseGeocode(myMap) {
        myMap.events.add('click', function (e) {
            var coords = e.get('coordPosition');

            ymaps.geocode(coords).then(function (res) {
                var names = [];
                res.geoObjects.each(function (obj) {
                    names.push(obj.properties.get('name'));
                });
                myMap.geoObjects.add(new ymaps.Placemark(coords, {
                    iconContent:names[0],
                    balloonContent:names.reverse().join(', ')
                }, {
                    preset:'twirl#redStretchyIcon',
                    balloonMaxWidth:'250'
                }));
            });
        });
    }
*/
}
</script>
</script>
</head>
<body style="font-family: Arial;border: 0 none;">
<p>Смертность населения в ДТП в расчете на 100 тыс. человек населения</p>
<div id="map" style="width: 800px; height: 300px"></div>
<div id="visualization" style="width: 800px; height: 280px;"></div>
<button type="button" onclick="debug1();">Click Me!</button></body>
</html>
​
